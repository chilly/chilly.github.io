<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.ico">
  <link rel="mask-icon" href="/icon.svg" color="#222">
  <meta name="google-site-verification" content="hcdiytqUGPoTW0eAaN6TWAmRfiv7IWFIIc9DKNr7Eno">
  <meta name="yandex-verification" content="eb8f01295fdccb3d">
  <meta name="baidu-site-verification" content="QoJxa8tZnO">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Times+New+Roman:300,300italic,400,400italic,700,700italic%7CRaleway:300,300italic,400,400italic,700,700italic%7COswald:300,300italic,400,400italic,700,700italic%7CWork+Sans:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"chillyc.info","root":"/","images":"/images","scheme":"Gemini","darkmode":true,"version":"8.18.1","exturl":true,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":true,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"utterances","storage":true,"lazyload":true,"nav":null,"activeClass":"utterances"},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":20,"unescape":false,"preload":false}}</script><script src="https://cdn.jsdelivr.net/npm/hexo-theme-next@8.18.1/source/js/config.min.js"></script>

    <meta property="og:type" content="website">
<meta property="og:title" content="帐前卒专栏">
<meta property="og:url" content="http://chillyc.info/page/25/">
<meta property="og:site_name" content="帐前卒专栏">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="帐前卒">
<meta property="article:tag" content="有意思的代码，有意思的架构, 有趣的小说, 好看的故事, code, software, articles, novel, architect">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://chillyc.info/page/25/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"en","comments":"","permalink":"","path":"page/25/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>帐前卒专栏 - code, software architect, articles and novels.<br/>代码，软件架构，博客和小说</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/rss2.xml" title="帐前卒专栏" type="application/rss+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <!-- Global site tag (gtag.js) - Google Analytics start -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-11621532-3"></script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6565392687771630"
     crossorigin="anonymous"></script>
<script>
  window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-11621532-3');
</script>
 <!-- Global site tag (gtag.js) - Google Analytics end -->
  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">帐前卒专栏</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">code, software architect, articles and novels.<br/>代码，软件架构，博客和小说</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li><li class="menu-item menu-item-sitemap"><a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>Sitemap</a></li><li class="menu-item menu-item-feeds"><a href="/rss2.xml" rel="section"><i class="fa fa-feed fa-fw"></i>feeds</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="帐前卒"
      src="/icon.svg">
  <p class="site-author-name" itemprop="name">帐前卒</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">796</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">25</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">754</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2NoaWxseQ==" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;chilly"><i class="fab fa-github fa-fw"></i>GitHub</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly90d2l0dGVyLmNvbS9jY3R0XzE=" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;cctt_1"><i class="fab fa-twitter fa-fw"></i>Twitter</span>
      </span>
  </div>
  <div class="cc-license animated" itemprop="license">
    <span class="exturl cc-opacity" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLW5kLzQuMC8="><img src="https://cdn.jsdelivr.net/npm/@creativecommons/vocabulary@2020.11.3/assets/license_badges/big/by_nc_nd.svg" alt="Creative Commons"></span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://chillyc.info/2010/06/21/2010-06-21-volatile-do/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/icon.svg">
      <meta itemprop="name" content="帐前卒">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="帐前卒专栏">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 帐前卒专栏">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2010/06/21/2010-06-21-volatile-do/" class="post-title-link" itemprop="url">What Does Volatile Do?</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2010-06-21 00:00:00" itemprop="dateCreated datePublished" datetime="2010-06-21T00:00:00+08:00">2010-06-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-10-05 23:05:08" itemprop="dateModified" datetime="2023-10-05T23:05:08+08:00">2023-10-05</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/code/" itemprop="url" rel="index"><span itemprop="name">code</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="Word count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Word count in article: </span>
      <span>3.1k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>3 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <meta name="_edit_last" content="1" />
<meta name="views" content="536" />
<meta name="_wp_old_slug" content="copy" />
copy from http://www.javaperformancetuning.com/news/qotm030.shtml
<p><strong>What does <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatile</span><br></pre></td></tr></table></figure> do?</strong></p>
<p>This is probably best explained by comparing the effects that <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatile</span><br></pre></td></tr></table></figure> and <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">synchronized</span><br></pre></td></tr></table></figure> have on a method. <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatile</span><br></pre></td></tr></table></figure> is a  field modifier, while <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">synchronized</span><br></pre></td></tr></table></figure> modifies code blocks and  methods. So we can specify three variations of a simple accessor using those two  keywords:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">         int i1;              int geti1() &#123;return i1;&#125;</span><br><span class="line">volatile int i2;              int geti2() &#123;return i2;&#125;</span><br><span class="line">         int i3; synchronized int geti3() &#123;return i3;&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">geti1()</span><br></pre></td></tr></table></figure> accesses the value currently stored in <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">i1</span><br></pre></td></tr></table></figure> <em>in the current thread</em>. Threads can have local copies of variables, and  the data does not have to be the same as the data held in other threads. In  particular, another thread may have updated <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">i1</span><br></pre></td></tr></table></figure> in it's thread, but the  value in the current thread could be different from that updated value. In  fact Java has the idea of a "main" memory, and this is the memory that holds the  current "correct" value for variables. Threads can have their own copy of data  for variables, and the thread copy can be different from the "main" memory.  So in fact, it is possible for the "main" memory  to have a value of 1 for <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">i1</span><br></pre></td></tr></table></figure>, for thread1 to have a value of 2 for <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">i1</span><br></pre></td></tr></table></figure> and for thread2 to  have a value of 3 for <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">i1</span><br></pre></td></tr></table></figure> if thread1 and thread2 have both updated <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">i1</span><br></pre></td></tr></table></figure> but those updated value has not yet been propagated to "main" memory or  other threads.
<p>On the other hand, <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">geti2()</span><br></pre></td></tr></table></figure> effectively accesses the value  of <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">i2</span><br></pre></td></tr></table></figure> from “main” memory. A <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatile</span><br></pre></td></tr></table></figure> variable is not allowed to  have a local copy of a variable that is different from the value currently held in “main”  memory. Effectively, a variable declared <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatile</span><br></pre></td></tr></table></figure> must have it’s data  synchronized across all threads, so that whenever you access or update the variable in any thread, all  other threads immediately see the same value. Of course, it is likely that <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatile</span><br></pre></td></tr></table></figure> variables have a higher access and update overhead than “plain”  variables, since the reason threads can have their own copy of data is for better efficiency.</p>
<p>Well if <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatile</span><br></pre></td></tr></table></figure> already synchronizes data across threads,  what is <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">synchronized</span><br></pre></td></tr></table></figure> for? Well there are two differences. Firstly <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">synchronized</span><br></pre></td></tr></table></figure> obtains and releases locks on monitors which  can force only one thread at a time to execute a code block, if both threads use  the same monitor (effectively the same object lock). That’s the fairly well known  aspect to <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">synchronized</span><br></pre></td></tr></table></figure>. But <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">synchronized</span><br></pre></td></tr></table></figure> also  synchronizes memory. In fact <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">synchronized</span><br></pre></td></tr></table></figure> synchronizes the whole of thread  memory with “main” memory. So executing <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">geti3()</span><br></pre></td></tr></table></figure> does the following:</p>
<ol>
	<li>The thread acquires the lock on the monitor for object <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">this</span><br></pre></td></tr></table></figure> (assuming the monitor is unlocked, otherwise the thread waits until the  monitor is unlocked).</li>
	<li>The thread memory flushes <em>all</em> its variables, i.e. it  has all of its variables effectively read from "main" memory (JVMs can use dirty sets to optimize  this so that only "dirty" variables are flushed, but conceptually this is the same. See  section 17.9 of the Java language specification).</li>
	<li>The code block is executed (in this case setting the return  value to the current value of <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">i3</span><br></pre></td></tr></table></figure>, which may have just been reset from "main"  memory).</li>
	<li>(Any changes to variables would normally now be written out to  "main" memory, but for <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">geti3()</span><br></pre></td></tr></table></figure> we have no changes.)</li>
	<li>The thread releases the lock on the monitor for object <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">this</span><br></pre></td></tr></table></figure>.</li>
</ol>
So where <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatile</span><br></pre></td></tr></table></figure> only synchronizes the value of one  variable between thread memory and "main" memory, <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">synchronized</span><br></pre></td></tr></table></figure> synchronizes  the value of all variables between thread memory and "main" memory, and locks and  releases a monitor to boot. Clearly <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">synchronized</span><br></pre></td></tr></table></figure> is likely to have  more overhead than <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatile</span><br></pre></td></tr></table></figure>.

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://chillyc.info/2010/06/17/5674707/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/icon.svg">
      <meta itemprop="name" content="帐前卒">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="帐前卒专栏">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 帐前卒专栏">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2010/06/17/5674707/" class="post-title-link" itemprop="url">微博系统</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2010-06-17 09:25:00" itemprop="dateCreated datePublished" datetime="2010-06-17T09:25:00+08:00">2010-06-17</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-10-05 12:41:45" itemprop="dateModified" datetime="2023-10-05T12:41:45+08:00">2023-10-05</time>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="Word count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Word count in article: </span>
      <span>195</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>1 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>貌似网上大家都使用Easytalk搭建微博系统。那东东使用php和mysql的。就是备案难了点，可以考虑放到米国。小量用户速度蛮快的，大量的用户没有测试过.<br />
…(废话ing)有个家伙做了一个IT的微博，就是贴代码麻烦了点，要先去<span class="exturl" data-url="aHR0cDovL3Bhc3RlYmluLnhuLS1jb20tencyZXI4Y3AxNGFvdmdnejRobmdj">http://pastebin.com那里发布成功<i class="fa fa-external-link-alt"></i></span>，然后再从分享那里贴进来。。。虽然<br />
webservice已经大行其道，但是真正的接口互用似乎还要等到在未来的若干年。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://chillyc.info/2010/06/17/2010-06-17-sizeof-c/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/icon.svg">
      <meta itemprop="name" content="帐前卒">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="帐前卒专栏">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 帐前卒专栏">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2010/06/17/2010-06-17-sizeof-c/" class="post-title-link" itemprop="url">Sizeof in C++</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2010-06-17 00:00:00" itemprop="dateCreated datePublished" datetime="2010-06-17T00:00:00+08:00">2010-06-17</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-10-06 22:54:04" itemprop="dateModified" datetime="2023-10-06T22:54:04+08:00">2023-10-06</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/code/" itemprop="url" rel="index"><span itemprop="name">code</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="Word count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Word count in article: </span>
      <span>1.8k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>2 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <meta name="_edit_last" content="1" />
<meta name="_su_description" content="the inside of sizeof
the inside of memory alignment" />
<meta name="_su_keywords" content="c++, sizeof, double, int, align,memory" />
<meta name="_su_title" content="c++, sizeof, double, int, align,memory" />
<meta name="views" content="1054" />
I use c++ in linux which is gcc version 4.4.1 (Ubuntu 4.4.1-4ubuntu9).
<p>I considered that c++ memory alignment is like the following:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">// pseudo-code of memory alignment</span><br><span class="line">remove_all_static_varibles();</span><br><span class="line">int max= 0;</span><br><span class="line">foreach(element in struct)</span><br><span class="line">    find_the_max_memory_used(element,&amp;amp;max);</span><br><span class="line">int align = max &amp;gt; default? default: max;</span><br><span class="line">// if max memory used for element is larger than the default, use default.</span><br><span class="line">int memory = sum(memory_used(elements));</span><br><span class="line"></span><br><span class="line">if(memory%align != 0)</span><br><span class="line">// here will execute alignment!</span><br><span class="line">&#123;</span><br><span class="line">    memory = (memory/align + 1 )*align;</span><br><span class="line">&#125;</span><br><span class="line">if(memory == 0)</span><br><span class="line">    memory = 1;</span><br><span class="line">return memory;</span><br></pre></td></tr></table></figure>
<p>vc++ use #pragma_pack(n) set the default.if there are three char in a struct, like:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">typedef struct&#123;</span><br><span class="line">	char a;</span><br><span class="line">	char b;</span><br><span class="line">	char c;</span><br><span class="line">&#125;X;</span><br><span class="line">sizeof(X); // it will be 3</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">typedef struct&#123;</span><br><span class="line">	char a;</span><br><span class="line">	short b;</span><br><span class="line"></span><br><span class="line">&#125;Y;</span><br><span class="line">sizeof(Y); // here will be 4</span><br><span class="line"></span><br><span class="line">typedef struct&#123;</span><br><span class="line">	char a;</span><br><span class="line">	int b;</span><br><span class="line">&#125;Z;</span><br><span class="line"></span><br><span class="line">sizeof(Z); // here will be 8</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">typedef struct&#123;</span><br><span class="line">	double a;</span><br><span class="line">	char b;</span><br><span class="line">&#125;W;</span><br><span class="line">sizeof(W);</span><br><span class="line">// it will be 12, the align is 4</span><br><span class="line">// when the max memory used is larger</span><br><span class="line">// than 4, it will be 4</span><br></pre></td></tr></table></figure>
<p>if the class or struct is empty, sizeof(it) will be 1.</p>
<p>But if there are static varibles in classes or structs, you can remove it!. like:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">class A&#123;</span><br><span class="line">	static int a;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line">sizeof(A); // it will be 1</span><br></pre></td></tr></table></figure>
<p>in class there will be many class functions. But A class is thought as A struct and many functions set. sizeof(A class) will compute the size of struct.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">class ZZ&#123;</span><br><span class="line">    public:</span><br><span class="line">        ZZ()&#123;</span><br><span class="line">            int a = 3;</span><br><span class="line">            cout &amp;lt;&amp;lt; &quot;I am ZZ&quot;&amp;lt;&amp;lt;endl;</span><br><span class="line">            cout &amp;lt;&amp;lt; a&amp;lt;&amp;lt;endl;</span><br><span class="line">        &#125;</span><br><span class="line">        ~ZZ()&#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    int c;</span><br><span class="line">&#125;;</span><br><span class="line">sizeof(ZZ); // will be 4;</span><br><span class="line">/* it is like a struct and two member functions.</span><br><span class="line">struct ZZ&#123;</span><br><span class="line">	int c;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">ZZ@ZZ() is name mingling</span><br><span class="line">ZZ@ZZ()&#123;</span><br><span class="line">	int a = 3;</span><br><span class="line">        cout &amp;lt;&amp;lt; &quot;I am ZZ&quot;&amp;lt;&amp;lt;endl;</span><br><span class="line">        cout &amp;lt;&amp;lt; a&amp;lt;&amp;lt;endl;</span><br><span class="line">&#125;</span><br><span class="line">ZZ@~ZZ()&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">*/</span><br></pre></td></tr></table></figure>
<p>but when we meet the virtual member functions and virtual derived class, it will be different.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://chillyc.info/2010/06/14/5671142/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/icon.svg">
      <meta itemprop="name" content="帐前卒">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="帐前卒专栏">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 帐前卒专栏">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2010/06/14/5671142/" class="post-title-link" itemprop="url">TravelMate 2040</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2010-06-14 18:31:00" itemprop="dateCreated datePublished" datetime="2010-06-14T18:31:00+08:00">2010-06-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-10-05 12:41:45" itemprop="dateModified" datetime="2023-10-05T12:41:45+08:00">2023-10-05</time>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="Word count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Word count in article: </span>
      <span>128</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>1 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>又拆了个本本，这个本本设计的不怎么合理。安装的时候严丝合缝，拆卸的时候就相当的麻烦。首先拧掉所有看得见的螺丝。先拆电源板，要先将屏转到180度，拆掉电源，然<br />
后再拆电源板。拆下电源板时，再拧掉键盘的螺丝和外壳螺丝。这里键盘的螺丝滑了…我就没有继续拆卸…zzz</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://chillyc.info/2010/05/27/5627160/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/icon.svg">
      <meta itemprop="name" content="帐前卒">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="帐前卒专栏">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 帐前卒专栏">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2010/05/27/5627160/" class="post-title-link" itemprop="url">Ignorance Bless You! 无知是福</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2010-05-27 09:23:00" itemprop="dateCreated datePublished" datetime="2010-05-27T09:23:00+08:00">2010-05-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-10-05 12:41:45" itemprop="dateModified" datetime="2023-10-05T12:41:45+08:00">2023-10-05</time>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="Word count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Word count in article: </span>
      <span>1.8k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>2 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>近期看一个电影&lt;二维平面&gt;(FlatLand),这个电影讲述的是二维平面中发生的故事.发现任何事物都很难脱离自身所在的环境想问题.二维中的square<br />
A就是这样.他只知东西南北四个方向,完全没有向上和向下的概念.所以圆球说线移动成面,面移动成体,对square A来说完全没有概念.但是当square A脱<br />
离了他原本所在的二维平面,他人也就大彻大悟了.如果有一维直线,也就有二维平面,如果有二维平面,也就会有三维立体空间,如果有三维立体空间,也就会存在四维世界.<br />
在二维世界中如果有人宣扬或者知道三维世界,就要被杀掉,因为不利于二维世界的统治.毕竟如果知道还有更高级的生命体或者个体存在,现在的体制就会土崩瓦解.并非出于<br />
惧怕,而是出于信仰.就如同如果神真的存在,那么人还有什么值得崇拜和推崇的?电光火石中争长短,几许光阴;蜗牛角上较雌雄,许大世界?不过真的有四维世界吗?这首先<br />
要论证真的有二维世界和一维世界吗?因为在我们的世界中暂时还找不到二维物体.想多了就晕,即使知道了事实也无法证明.即使证明了也会引来杀身之祸.所以无知是福.觉<br />
得非常奇怪的一点就是知道了就去宣扬,这让我想到日心说.想来哥白尼的确是位智者.当然逼哥白尼临终发表天体运行论的那群人也很聪明.相反布鲁诺多多少少有些愚钝.不<br />
过提点别人的错误,往往自己也抱持相同的错误.最后用白居不易的&lt;对酒&gt;一诗结束此文:蜗牛角上争何事,石火光中寄此身,随贫随福且欢乐,不开口笑是痴人.</p>
<p>** 中 文名 ** :  二维电影</p>
<p>** 英文名 ** :  Flatland</p>
<p>** 别名 ** :  Flatland the Film</p>
<p>** IMDb ** :  <span class="exturl" data-url="aHR0cDovL3d3dy5pbWRiLmNvbS90aXRsZS90dDk3MjM3NC8="> 7.0/10 (455 votes) <i class="fa fa-external-link-alt"></i></span></p>
<p>** 资 源格式 ** :  DVDRip</p>
<p>** 发行日期 ** :  2007年</p>
<p>** 导 演 ** :  <span class="exturl" data-url="aHR0cDovL3d3dy52ZXJ5Y2QuY29tL3NlYXJjaC9zdGFyL0xhZGQrRWhsaW5nZXIrSnIu"> Ladd Ehlinger Jr. <i class="fa fa-external-link-alt"></i></span></p>
<p>** 演员 ** :  <span class="exturl" data-url="aHR0cDovL3d3dy52ZXJ5Y2QuY29tL3NlYXJjaC9zdGFyL0NocmlzK0NhcnRlcg=="> Chris Carter … King Of Lineland <i class="fa fa-external-link-alt"></i></span><br />
<a target="_blank" rel="noopener" href="http://www.verycd.com/search/star/Megan+Colleen"> Megan Colleen … A Hexagon<br />
</a><br />
<a target="_blank" rel="noopener" href="http://www.verycd.com/search/star/Ladd+Ehlinger+Jr."> Ladd Ehlinger Jr. … A Square<br />
</a><br />
<a target="_blank" rel="noopener" href="http://www.verycd.com/search/star/Oscar+Gutierrez"> Oscar Gutierrez … Old Trapezoid<br />
</a><br />
<a target="_blank" rel="noopener" href="http://www.verycd.com/search/star/Simon+Hammond"> Simon Hammond … A Sphere<br />
</a><br />
<a target="_blank" rel="noopener" href="http://www.verycd.com/search/star/Michael+Karle"> Michael Karle … Pentagon Doctor<br />
</a><br />
<a target="_blank" rel="noopener" href="http://www.verycd.com/search/star/Jeff+Sanders"> Jeff Sanders … Cube Carlton<br />
</a><br />
<a target="_blank" rel="noopener" href="http://www.verycd.com/search/star/Jonathon+Shoemaker"> Jonathon Shoemaker … Soldier X<br />
</a><br />
<a target="_blank" rel="noopener" href="http://www.verycd.com/search/star/Gregory+Trent"> Gregory Trent … President Circle<br />
</a></p>
<p>** 地区 ** :  <span class="exturl" data-url="aHR0cDovL3d3dy52ZXJ5Y2QuY29tL3NlYXJjaC9hcmVhL3VzYQ=="> 美国 <i class="fa fa-external-link-alt"></i></span></p>
<p>** 语 言 ** :  <span class="exturl" data-url="aHR0cDovL3d3dy52ZXJ5Y2QuY29tL3NlYXJjaC9sYW5nL2VuZ2xpc2g="> 英语 <i class="fa fa-external-link-alt"></i></span></p>
<p>** 简 介 ** :</p>
<p>[ ](<span class="exturl" data-url="aHR0cDovL2ltYWdlLTEudmVyeWNkLmNvbS8zZWI2MmI1ZTZlYjVhYmEzY2Q3OTUzMGE1MDAzN2MyODQ1NjA5L3Bvc3QtMzI1OTU=">http://image-1.verycd.com/3eb62b5e6eb5aba3cd79530a50037c2845609/post-32595<i class="fa fa-external-link-alt"></i></span><br />
9-1221031016.jpg)<br />
<img src="http://hi.csdn.net/attachment/201005/28/0_1275033369mMv1.gif" alt="" /></p>
<p>◎译　　名 　二维电影<br />
◎片　　名　Flatland<br />
◎年　　代　2007<br />
◎国　　家　美国<br />
◎类　　别　动画/奇幻/科幻<br />
◎ 语　　言　英语<br />
◎字　　幕　N/A<br />
◎IMDB评分 7.4/10 (253 votes)<br />
◎IMDB链接 <a target="_blank" rel="noopener" href="http://www.imdb.com/title/tt0972374"> http://www.imdb.com/title/tt0972374<br />
</a><br />
◎文件格式　XviD + MP3<br />
◎视频尺寸　656 x 272<br />
◎文件大小　1CD 49 x 15MB<br />
◎片　　长　99 Mins<br />
◎导　　演　 Ladd Ehlinger Jr.<br />
◎主　　演　Chris Carter … King Of Lineland<br />
Megan Colleen … A Hexagon<br />
Ladd Ehlinger Jr. … A Square<br />
Oscar Gutierrez … Old Trapezoid<br />
Simon Hammond … A Sphere<br />
Michael Karle … Pentagon Doctor<br />
Jeff Sanders … Cube Carlton<br />
Jonathon Shoemaker … Soldier X<br />
Gregory Trent … President Circle</p>
<p>◎简　　介</p>
<p>Flatland: The Movie是由1884年一位英国牧师Edwin A.<br />
Abbott(1838-1926)所撰写的一本小册子《Flatland》改编的一部动画片。小说里构造了一个全新的世界──这个世界是二维的！整个小<br />
说分成两个部分，前一部分系统地描述这个二维世界，包括自然状况、居民生活、政治历史等等。真正有趣的事情发生在后一部分里，这里不同维度的世界之间发生<br />
了碰撞——二维世界中的主人公拜访了一维世界，同时又接触到了一个全新的三维世界。当他在他的世界传播三维思想时，整个世界大乱，哥白尼时代的那段故事再 次发生。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://chillyc.info/2010/05/26/2010-05-26-climbing-wall/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/icon.svg">
      <meta itemprop="name" content="帐前卒">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="帐前卒专栏">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 帐前卒专栏">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2010/05/26/2010-05-26-climbing-wall/" class="post-title-link" itemprop="url">Climbing Wall?</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2010-05-26 00:00:00" itemprop="dateCreated datePublished" datetime="2010-05-26T00:00:00+08:00">2010-05-26</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-10-07 11:42:24" itemprop="dateModified" datetime="2023-10-07T11:42:24+08:00">2023-10-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/knowledge/" itemprop="url" rel="index"><span itemprop="name">knowledge</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="Word count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Word count in article: </span>
      <span>68</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>1 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <meta name="_edit_last" content="1" />
<meta name="_su_rich_snippet_type" content="none" />
<meta name="views" content="495" />
<meta name="_wp_old_slug" content="" />
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/sh</span><br><span class="line">plink -ssh -D 7070 -P 22 -pw &quot;$1&quot; freessh@a.freessh.us</span><br><span class="line"></span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://chillyc.info/2010/05/24/architect/design-patten/2010-05-24-design-pattern-chain-reponsibility/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/icon.svg">
      <meta itemprop="name" content="帐前卒">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="帐前卒专栏">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 帐前卒专栏">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2010/05/24/architect/design-patten/2010-05-24-design-pattern-chain-reponsibility/" class="post-title-link" itemprop="url">Design Pattern CHAIN of Reponsibility</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2010-05-24 00:00:00" itemprop="dateCreated datePublished" datetime="2010-05-24T00:00:00+08:00">2010-05-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-10-05 23:03:16" itemprop="dateModified" datetime="2023-10-05T23:03:16+08:00">2023-10-05</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/architect/" itemprop="url" rel="index"><span itemprop="name">architect</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="Word count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Word count in article: </span>
      <span>2k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>2 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <meta name="_edit_last" content="1" />
<meta name="_su_description" content="design pattern CHAIN of reponsibility" />
<meta name="_su_keywords" content="design pattern CHAIN of reponsibility" />
<meta name="_su_title" content="design pattern CHAIN of reponsibility" />
<meta name="views" content="603" />
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line">#include&amp;lt;cstdio&amp;gt;</span><br><span class="line"></span><br><span class="line">using namespace std;</span><br><span class="line">namespace pattern&#123;</span><br><span class="line">	/// this pattern links all handler as a line, if previous handler can process a request, it wil not be</span><br><span class="line">	/// send to next handler. For example, if someone requested changing programming style, </span><br><span class="line">	/// this decision will be made by a programmer. </span><br><span class="line">	/// He will change his programming style without noticing his lead. </span><br><span class="line">	/// But if someone request changing the requirements, the programmer can not make this decision. </span><br><span class="line">	/// He will noticing his lead, and make his lead decided.</span><br><span class="line"></span><br><span class="line">	/// this is request class.</span><br><span class="line">	#define STYLE 0</span><br><span class="line">	#define REQIREMENT 1</span><br><span class="line">	class Request&#123;</span><br><span class="line">		public:</span><br><span class="line">			int type; // changing programming style or changing requirements?</span><br><span class="line"></span><br><span class="line">	&#125;;</span><br><span class="line"></span><br><span class="line">	/// this class for processing request.</span><br><span class="line">	class Handler&#123;</span><br><span class="line">	private:</span><br><span class="line">		Handler* parent;</span><br><span class="line">	public:</span><br><span class="line">		Handler(Handler* p):parent(p)&#123;&#125;</span><br><span class="line">		virtual bool DoHandle(Request&amp;amp; r)=0;</span><br><span class="line">		void Process(Request&amp;amp; r);</span><br><span class="line">		virtual ~Handler()&#123;&#125;</span><br><span class="line">	&#125;;</span><br><span class="line"></span><br><span class="line">	void Handler::Process(Request&amp;amp; r)&#123;</span><br><span class="line">		if(!this-&amp;gt;DoHandle(r) &amp;amp;&amp;amp; NULL != parent)&#123;</span><br><span class="line">			parent-&amp;gt;Process(r);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	class Programmer: public Handler&#123;</span><br><span class="line">		public:</span><br><span class="line">		Programmer(Handler* p):Handler(p)&#123;&#125;</span><br><span class="line">		virtual bool DoHandle(Request&amp;amp; r);</span><br><span class="line"></span><br><span class="line">	&#125;;</span><br><span class="line">	bool Programmer::DoHandle(Request&amp;amp; r)&#123;</span><br><span class="line">		if(r.type == STYLE)&#123;</span><br><span class="line">			printf(&quot;programmer: I can process changing programming style\n&quot;);</span><br><span class="line">			return true;</span><br><span class="line">		&#125;else&#123;</span><br><span class="line">			printf(&quot;programmer: I can not process this request. I will report this to my lead!\n&quot;);</span><br><span class="line">			return false;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	class Lead:public Handler&#123;</span><br><span class="line">		public:</span><br><span class="line">		Lead(Handler* p):Handler(p)&#123;&#125;</span><br><span class="line">		virtual bool DoHandle(Request&amp;amp; r);</span><br><span class="line"></span><br><span class="line">	&#125;;</span><br><span class="line">	bool Lead::DoHandle(Request&amp;amp; r)&#123;</span><br><span class="line">		if(r.type == REQIREMENT)&#123;</span><br><span class="line">			printf(&quot;lead: I will process changing reqirements\n&quot;);</span><br><span class="line">			return true;</span><br><span class="line">		&#125;</span><br><span class="line">		return false;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">int main()&#123;</span><br><span class="line">	pattern::Lead lead((pattern::Handler*)NULL);</span><br><span class="line">	pattern::Programmer programmer(&amp;amp;lead);</span><br><span class="line">	pattern::Request r;</span><br><span class="line">	r.type = STYLE;</span><br><span class="line">	programmer.Process(r);</span><br><span class="line">	r.type = REQIREMENT;</span><br><span class="line">	programmer.Process(r);</span><br><span class="line">	return 0;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://chillyc.info/2010/05/23/5618652/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/icon.svg">
      <meta itemprop="name" content="帐前卒">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="帐前卒专栏">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 帐前卒专栏">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2010/05/23/5618652/" class="post-title-link" itemprop="url">在Ubuntu下生成大文件,并测试文件读写效率</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2010-05-23 21:40:00" itemprop="dateCreated datePublished" datetime="2010-05-23T21:40:00+08:00">2010-05-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-10-05 12:41:45" itemprop="dateModified" datetime="2023-10-05T12:41:45+08:00">2023-10-05</time>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="Word count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Word count in article: </span>
      <span>4.1k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>4 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>在ubuntu或者其他的linux下生成大文件,必须使用编译参数  -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64.否<br />
则生成的文件一定是2G左右的,原因是fseek,这个函数中的offset参数是一个long型的或者是size_t型的,在fseeko中是off_t,但是这个<br />
off_t默认还是32位,只有加了  -D_FILE_OFFSET_BITS=64的宏定义才被作为64位对待.</p>
<p>写了下面一段代码来生成大文件,传说有一种方法:直接跳转nG位置之后,然后写入一个字符.这种方法可能更快,不过我为了保守的生成文件,还是使用下面的一个写法:</p>
<p>#include&lt;stdio.h&gt; #include&lt;stdlib.h&gt; #include&lt;unistd.h&gt; #include&lt;string.h&gt;<br />
void gen_file(const char <em>filename, int block_size, int count){ int is_exist =<br />
0; FILE</em> file = fopen(filename,“w+b”); char * buf = NULL; int i=0; long long<br />
size = block_size; if(file == NULL){ printf(“fatal error in gen_file:<br />
fopen/n”); exit(1); } buf = (char <em>)malloc(sizeof(char)<em>block_size);<br />
memset(buf,‘1’,sizeof(char)<em>block_size); while(i++&lt;count){ if(i % 10 == 0){<br />
printf(“count is %d, size is %lld/n”,i,size); } fwrite(buf,block_size,1,file);<br />
size += block_size; fseeko(file,size,SEEK_SET); } fclose(file); free(buf); /</em><br />
long long size = 1024</em>1024</em>1024; size <em>=10; fseeko(file,size,SEEK_SET);<br />
fwrite(buf,block_size,1,file); fclose(file); free(buf); <em>/ } int main(){<br />
printf(“size of char %d/n”,sizeof(char)); int block_size = 1024</em>1024</em>20; //<br />
20M int count = 50; gen_file(“smallfile”,block_size,count*2);// gen 2G file<br />
return 0; }</p>
<p>int block_size = 1024<em>1024</em>20; // 20M</p>
<p>这个是每次写入的数据大小,gen_file(“smallfile”,block_size,count*2);第三个参数可以调节生成文件的大小.</p>
<p>下面写了一个测试大文件和小文件的随机读写和顺序读写.</p>
<p>#include&lt;stdio.h&gt; #include&lt;time.h&gt; #include&lt;sys/stat.h&gt; #include&lt;sys/types.h&gt;<br />
#include&lt;unistd.h&gt; #include&lt;stdlib.h&gt; #include&lt;sys/time.h&gt; #include&lt;string.h&gt;<br />
const int block_size = 8092; struct timeval start; struct timeval end; struct<br />
timezone tz; void start_time(){ gettimeofday(&amp;start,&amp;tz); } void end_time(){<br />
gettimeofday(&amp;end,&amp;tz); } void print_time(){ printf(“%lf sec/n”,(end.tv_sec-<br />
start.tv_sec)+(double)(end.tv_usec-start.tv_usec)/1000000); } size_t<br />
look_size(const char * filename){ struct stat st; stat(filename,&amp;st); return<br />
st.st_size; } void read_blocks(FILE* file, off_t offset,int block_size){ int<br />
where = offset<em>block_size; fseeko(file,where,0); } FILE</em> fopen_safe(const char</p>
<ul>
<li>filename){ FILE* file = fopen(filename,“r”); if(file == NULL){ printf(“fatal<br />
error in random_read, open file”); exit(1); } return file; } void<br />
random_read(const char * filename){ int random; size_t size; FILE* file =<br />
fopen_safe(filename); size = look_size(filename)/block_size; random =<br />
rand()%size; read_blocks(file,random,block_size); fclose(file); } void<br />
order_read(const char <em>filename,int order){ size_t size; FILE</em> file =<br />
fopen_safe(filename); size = look_size(filename)/block_size;<br />
read_blocks(file,order%size,block_size); fclose(file); } void<br />
random_test(const char * filename,int times){ int count = 0; start_time();<br />
while(count++&lt;times){ // access Big File random_read(filename); } end_time();<br />
print_time(); } void order_test(const char * filename, int times){ int count =<br />
0; start_time(); while(count++&lt;times){ order_read(filename,count); }<br />
end_time(); print_time(); } void random_test_diff(const char * basename,int<br />
num,int times){ int count = 0; char ** names = malloc(sizeof(char)*num); int<br />
len = strlen(basename); int i = 0; while( i &lt; num){ names[i] =<br />
malloc(sizeof(char)*len+4); sprintf(names[i],“%s_%d”,basename,i); i++; }<br />
start_time(); while(count++&lt;times){ if(count &lt; 900){ random_read(names[0]); }<br />
else { if(count &lt; 960){ random_read(names[count%num]);<br />
random_read(names[(count+1)%num]); } if(count &lt; 1000){<br />
random_read(names[count%num]); random_read(names[(count+1)%num]);<br />
random_read(names[(count+2)%num]); } } } end_time(); print_time(); } int<br />
main(){ int i,count; int times = 1000; count = 0; // clock_t start,end;<br />
srand(time(NULL)); char * filename=“bigfile”; //printf(“time is %lf”,((double<br />
)(end-start))/CLOCKS_PER_SEC); random_test(filename,times);<br />
order_test(filename,times); times = times; filename = “smallfile”;<br />
random_test(filename,times); order_test(filename,times);<br />
random_test_diff(filename,3,times); return 0; }</li>
</ul>
<p>当然你这里做测试的时候可以把gettimeofday替换为clock()或者time()函数,其中clock()是程序实际运行的时间,你感觉可能执行了七八秒<br />
,其实程序只占用cpu执行了1秒.如果是time()函数或者gettimeofday()函数就是真正的运行时间也就是你感觉执行的时间.所以各有千秋,前者是为<br />
了排除各种运行环境中的软件或者os的不同,单独检测程序的效率.后者是在系统环境中程序的执行时间.</p>
<p>下面是我得到的结论,创建1个10G文件,创建3个2G小文件.<br />
大文件 随机访问7.199645 sec<br />
大文件 顺序访问0.013617 sec<br />
单个小文件 随机访问5.119245 sec<br />
小文件 顺序访问0.014190 sec<br />
多个小文件的随机访问测试:90%的几率访问同一个小文件，6%访问两个小文件，4%访问3个小文件 9.791248<br />
sec.并且90%几率发生在前,所以如果随机发生多个文件的随机访问,那么可能速度会更慢.这里慢的原因,是因为fopen.</p>
<p>这也就是数据库为什么只有一个数据文件的原因.有时进行文件切分,反而不利于效率的提高.但是对于100G以上的大文件,是否这个结论又要改变了呢?我没有做过这个实<br />
验.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://chillyc.info/2010/05/23/5617749/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/icon.svg">
      <meta itemprop="name" content="帐前卒">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="帐前卒专栏">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 帐前卒专栏">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2010/05/23/5617749/" class="post-title-link" itemprop="url">Csdn举办的云计算大会——总结思考篇</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2010-05-23 11:05:00" itemprop="dateCreated datePublished" datetime="2010-05-23T11:05:00+08:00">2010-05-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-10-05 12:41:45" itemprop="dateModified" datetime="2023-10-05T12:41:45+08:00">2023-10-05</time>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="Word count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Word count in article: </span>
      <span>1.2k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>1 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>这次大会的演讲嘉宾的内容参差不齐，有好有坏。</p>
<p>有时个人觉得听上面的人吹来吹去，不如听听各个展台的工程师是怎么做的。</p>
<p>个人感觉csdn实在是没有钱。既然没有钱就不要打肿脸充胖子乱搞活动。中午就发个三明治。还不如不发餐卷，或者写自带午餐或者请到外面的成都小吃自己买饭吃。我实在<br />
不知道处于什么目的，发一个精美的袋子，里面就一点点吃的。本以为是午餐前的餐点，后来才真的相信这就是午餐。</p>
<p>传说第一届的午餐也是三明治，但是人家是不要钱的!另外第一、二天其实没有票也是可以去听的。当初实验室真不如把钱给我们算了。</p>
<p>去那里发现许多人和我有同样的问题，有一部分解答了，有一部分还在思考研究中：</p>
<p>１。服务器利用率的提高，是否是真正利用了？这部分利用率是用于虚拟化，还是用于真正的业务？VMware的工程师说，资源只用5%消耗在虚拟化上。这个5%并不随着<br />
虚拟机的增多而线性增加。当然，我还是不信…</p>
<p>２。当两台虚拟机在同一个机器中运行，是有公平的弹性机制(你不用时我用，我不用时你用，你我都用时对半分)，也就是balloom技术。至于这个技术是啥米，有待研<br />
究，但是从xcp中看到了Memory Balloom,不知道是否是同样的东东。</p>
<p>３。当应用需消耗大量资源的程序，如果在一台物理服务器上跑得很吃力，那么就别寻求云计算。</p>
<p>４。程序必须有并发性。如果云计算平台能屏蔽分布式物理机带来的进程通信的影响，那么多进程的编程是必要的。如果云计算可以只把线程迁移到其他物理机器上，那就更好了<br />
，不过我知道那是天方夜谭。</p>
<p>５。如果我的物理机器都只是两核的，那么我也就不会虚拟出四核的机器。</p>
<p>６。一台虚拟机器可以使用另外一台物理机器的存储资源(硬盘)？当时那个工程师说可以。那是因为那台物理机器开启了另外一个VM实例,还是没有开？</p>
<p>７。chinaCache说Xen比vmware好，因为xen是os层虚拟化，vmware说vmware最好，因为vmware稳定。其实vmware传说也有自<br />
己的os虚拟化技术。</p>
<p>８。mysql在chinaCache中效率比EC2高３倍。因为它是一个机器中的本地存储，而EC2可以看作使用了存储网络，所以EC2会有线路传输带宽的消耗。我<br />
个人认为chinaCache没有办法大量持续扩容的.否则性能会降低到EC2的水平。</p>
<p>９。如果因为一台物理机中太多虚拟机共同消耗资源，而导致某些井喷业务不能响应，那么会将这些业务迁移到其他机器中。但是它的监控器都无法响应了，它怎么知道哪个业务<br />
是井喷业务呢？</p>
<p>10。以后会议别请高层了，乱忽悠。另外我不太清楚服务器是什么概念？如果是高级稳定机器来说，我们实验室就两台服务器。如果随便的pc机就可以做服务器，那归我管的<br />
服务器就有4~5台。我觉得业界还没有统一服务器的概念。</p>
<p>11。大云其实就是做了基于MapReduce的数据挖掘算法…</p>
<p>12.中移动说现在已经可以支持5000台服务器，那是Yahoo的hadoop.其实我不太相信他有这么多机器。(他的服务器是啥概念？)</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://chillyc.info/2010/05/10/database/2010-05-10-debug-postgresql/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/icon.svg">
      <meta itemprop="name" content="帐前卒">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="帐前卒专栏">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 帐前卒专栏">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2010/05/10/database/2010-05-10-debug-postgresql/" class="post-title-link" itemprop="url">How to Debug PostgreSQL</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2010-05-10 00:00:00" itemprop="dateCreated datePublished" datetime="2010-05-10T00:00:00+08:00">2010-05-10</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-10-06 22:54:03" itemprop="dateModified" datetime="2023-10-06T22:54:03+08:00">2023-10-06</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/code/" itemprop="url" rel="index"><span itemprop="name">code</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="Word count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Word count in article: </span>
      <span>1.1k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>1 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <meta name="_edit_last" content="1" />
<meta name="_su_description" content="postgresql debug" />
<meta name="_su_keywords" content="postgresql debug" />
<meta name="_su_title" content="postgresql debug" />
<meta name="views" content="1123" />
First, compile the source code use ./configure --prefix=XXXX --enable-debug &amp;&amp; CFLAGS=-O0
<p>then make and make install.</p>
<h2><span style="color: #800000;">IF you want to RESTART PG</span></h2>
Detected if there is an instance of Postgre server. If there is, kill it. use
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ps -e | grep postgre</span><br><span class="line">// find id of the process</span><br><span class="line">kill -9 $processid</span><br></pre></td></tr></table></figure>
<p>to detect the pocess of postgresql and kill it.</p>
<p>then use:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">gdb postgresqlHomeDIR/bin/postgres -quiet</span><br><span class="line">// enter gdb then use</span><br><span class="line">set args -D DATADIR</span><br><span class="line">run</span><br></pre></td></tr></table></figure>
<p>here DATADIR and postgresqlDIR are your own directory.</p>
<h2><span style="color: #800000;">IF you don't want to RESTART PG</span></h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// find postgres pid</span><br><span class="line">pid = `ps auxww | \</span><br><span class="line">    grep postgres: | \</span><br><span class="line">    grep -v -e &#x27;grep postgres:&#x27; -e &#x27;postgres: stats&#x27; -e &#x27;postgres: writer&#x27; -e &#x27;postgres: archiver&#x27; -e &#x27;postgres: logger&#x27; -e &#x27;postgres: autovacuum&#x27; | \</span><br><span class="line">    tee /dev/tty | \</span><br><span class="line">    awk &#x27;&#123;print $2&#125;&#x27;`</span><br><span class="line">gdb pid</span><br></pre></td></tr></table></figure>
<p>then use</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./psql test</span><br></pre></td></tr></table></figure>
<p>to test. Here test is  your database name.</p>
<p>IF you want to debug contrib</p>
<p>make &amp;&amp; make install in contrib/yourdir</p>
<p>then go to gdb to file your shard lib to load symbol. Here <span class="exturl" data-url="aHR0cDovL1hYWC5zbw==">XXX.so<i class="fa fa-external-link-alt"></i></span> is your contrib share lib.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(gdb) file XXX.so</span><br></pre></td></tr></table></figure>
<p>if not, when you use break somefunction, it will report:</p>
<p>No symbol table is loaded.  Use the “file” command.<br />
Make breakpoint pending on future shared library load? (y or [n])</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" title="Previous page" aria-label="Previous page" href="/page/24/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/24/">24</a><span class="page-number current">25</span><a class="page-number" href="/page/26/">26</a><span class="space">&hellip;</span><a class="page-number" href="/page/80/">80</a><a class="extend next" rel="next" title="Next page" aria-label="Next page" href="/page/26/"><i class="fa fa-angle-right"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 2017 – 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">帐前卒</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
      <span>Word count total: </span>
    <span title="Word count total">1.6m</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span>Reading time total &asymp;</span>
    <span title="Reading time total">24:18</span>
  </span>
</div>

    </div>
  </footer>

  
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/hexo-theme-next@8.18.1/source/js/comments.min.js"></script><script src="https://cdn.jsdelivr.net/npm/hexo-theme-next@8.18.1/source/js/utils.min.js"></script><script src="https://cdn.jsdelivr.net/npm/hexo-theme-next@8.18.1/source/js/motion.min.js"></script><script src="https://cdn.jsdelivr.net/npm/hexo-theme-next@8.18.1/source/js/next-boot.min.js"></script><script src="https://cdn.jsdelivr.net/npm/hexo-theme-next@8.18.1/source/js/bookmark.min.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/hexo-generator-searchdb@1.4.1/dist/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/hexo-theme-next@8.18.1/source/js/third-party/search/local-search.min.js"></script>







  




  

  <script class="next-config" data-name="enableMath" type="application/json">false</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css" integrity="sha256-3574TpfThVfeAhg+I4+N39EJiLN3QUkuEsMVe8hWAR4=" crossorigin="anonymous">


<script class="next-config" data-name="utterances" type="application/json">{"enable":true,"repo":"chilly/blog_comments","issue_term":"url","theme":"github-dark"}</script>
<script src="https://cdn.jsdelivr.net/npm/hexo-theme-next@8.18.1/source/js/third-party/comments/utterances.min.js"></script>

</body>
</html>
